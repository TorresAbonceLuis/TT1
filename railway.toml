[build]
builder = "NIXPACKS"
# ELIMINAR ESTA LÍNEA: buildCommand = "source $NIXPACKS_ACTIVATE_ENV && pip install -r requeriment.txt" 

[deploy]
# MANTENER la corrección del inicio, que es la forma más robusta de arrancar la app.
startCommand = "python3 -m uvicorn main:app --host 0.0.0.0 --port $PORT" 
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

[nixpacks]
nixpkgs = [
    "python39",
    "lilypond",
    "pip" # Dejar 'pip' aquí para asegurar que se instala como binario.
]